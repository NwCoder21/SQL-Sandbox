# Queries

# Introduction

Here, will cover SQL commands to query a single table in a database.

One of the core purposes of the SQL language is to retrieve information stored in a database. This is commonly referred to as **querying**.
Queries allow us to communicate with the database by asking questions and returning a result set with data relevant to the question. 

We will be querying a database with one table named `movies`. The columns for this table are `id`, `name`, `genre`, `year`, and `imdb_rating`.

When we run `SELECT * FROM movies`, this is what we will see:

![image](https://user-images.githubusercontent.com/107522496/208546672-12ce1779-ca8a-401d-8649-c8283e4c6442.png)
![image](https://user-images.githubusercontent.com/107522496/208546796-ca830b3b-1ba2-4d23-aacc-4153d3759de7.png)
![image](https://user-images.githubusercontent.com/107522496/208546853-5a7bb9cf-50f5-434e-99d4-706ad5d138b5.png)
![image](https://user-images.githubusercontent.com/107522496/208546911-78004cd8-5adf-4084-adab-1443f1d7bda0.png)
![image](https://user-images.githubusercontent.com/107522496/208547001-af26d8cd-ec0c-47d8-87ae-e76a9d81ef93.png)

This is the whole table.

---


```sql
CREATE TABLE movies (
id INT AUTO_INCREMENT PRIMARY KEY,
name TEXT,
genre TEXT,
year INT,
imdb_rating INT
);

INSERT INTO movies (name, genre, year, imdb_rating)
VALUES('Avatar','action',2099,7.9),
('Jurassic World','action',2015,7.3),
('The Avengers','action',2012,8.1),
('The Dark Knight','action',2008,9.0),
('Star Wars: Episode I - The Phantom Menace','action',1999,6.6),
('Star Wars','action',1977,8.7),
('Avengers: Age of Ultron ','action',2015,7.9),
('The Dark Knight Rises','action',2012,8.5),
('Pirates of the Caribbean: Dead Mans Chest','action',2006,7.3),
('Iron Man 3','action',2013,7.3),
('Spider-Man','action',2022,7.3),
('Transformers: Revenge of the Fallen','action',2009,6.0),
('Star Wars: Episode III - Revenge of the Sith','action',2005,7.7),
('Spider-Man 2','action',2004,7.3),
('Transformers: Dark of the Moon','action',2011,6.3),
('American Sniper','action',2014,7.4),
('Furious Seven','action',2015,7.4),
('Spider-Man 3','action',2007,6.2),
('Guardians of the Galaxy','action',2014,8.1),
('Transformers','action',2007,7.1),
('Iron Man','action',2008,7.9),
('Indiana Jones and the Kingdom of the Crystal Skull','action',2008,6.2),
('Iron Man 2','action',2010,7.1),
('Star Wars: Episode II - Attack of the Clones','action',2002,6.7),
('Pirates of the Caribbean: At Worlds End','action',2007,7.1),
('Star Wars: Episode VI - Return of the Jedi','action',1983,8.4),
('Independence Day','action',1996,6.9),
('Pirates of the Caribbean: The Curse of the Black Pearl','action',2003,8.1),
('Skyfall','action',2012,7.8),
('Inception','action',2010,8.8),
('Man of Steel','action',2013,7.2),
('Star Wars: Episode V - The Empire Strikes Back','action',1980,8.8),
('The Matrix Reloaded','action',2003,7.2),
('The Amazing Spider-Man','action',2012,7.1),
('The Incredibles','action',2004,8.0),
('Captain America: The Winter Soldier','action',2014,7.8),
('The Lego Movie','action',2014,7.8),
('Star Trek','action',2009,8.0),
('Batman','action',1989,7.6),
('Night at the Museum','action',2006,6.4),
('Transformers: Age of Extinction','action',2014,5.8),
('Twister','action',1996,6.3),
('Maleficent','action',2014,7.0),
('Pirates of the Caribbean: On Stranger Tides','action',2011,6.7),
('Fast & Furious 6','action',2013,7.2),
('Beverly Hills Cop','action',1984,7.3),
('X-Men: The Last Stand','action',2006,6.8),
('X-Men: Days of Future Past','action',2014,8.1),
('The Lost World: Jurassic Park','action',1997,6.5),
('Star Trek Into Darkness','action',2013,7.8),
('Shrek 2','comedy',2004,7.2),
('Toy Story 3','comedy',2010,8.4),
('Frozen','comedy',2013,7.6),
('Finding Nemo','comedy',2003,8.2),
('Despicable Me 2','comedy',2013,7.5),
('Inside Out','comedy',2015,8.6),
('Shrek the Third','comedy',2007,6.0),
('Minions','comedy',2015,6.7),
('Up','comedy',2009,8.3),
('Monsters, Inc.','comedy',2001,8.1),
('Home Alone','comedy',1990,7.4),
('Meet the Fockers','comedy',2004,6.3),
('The Hangover','comedy',2009,7.8),
('Monsters University','comedy',2013,7.4),
('Shrek','comedy',2001,7.9),
('How the Grinch Stole Christmas','comedy',2000,6.0),
('The Hangover Part II','comedy',2011,6.5),
('Despicable Me','comedy',2010,7.7),
('Men in Black','comedy',1997,7.2),
('Toy Story 2','comedy',1999,7.9),
('Cars','comedy',2006,7.2),
('Bruce Almighty','comedy',2003,6.7),
('My Big Fat Greek Wedding','comedy',2002,6.6),
('Shrek Forever After','comedy',2010,6.4),
('Brave','comedy',2012,7.2),
('Ghostbusters','comedy',1984,7.8),
('Rush Hour 2','comedy',2001,6.6),
('Big Hero 6','comedy',2014,7.9),
('Alvin and the Chipmunks: The Squeakquel','comedy',2009,4.4),
('Mrs. Doubtfire','comedy',1993,6.9),
('Ted','comedy',2012,7.0),
('Aladdin','comedy',1992,8.0),
('Alvin and the Chipmunks','comedy',2007,5.3),
('Madagascar 3: Europes Most Wanted','comedy',2012,7.0),
('Kung Fu Panda','comedy',2008,7.6),
('The Lorax','comedy',2012,6.5),
('Austin Powers in Goldmember','comedy',2002,6.2),
('Back to the Future','comedy',1985,8.5),
('Wedding Crashers','comedy',2005,7.0),
('Charlie and the Chocolate Factory','comedy',2005,6.7),
('Ratatouille','comedy',2007,8.0),
('Austin Powers: The Spy Who Shagged Me','comedy',1999,6.6),
('Tangled','comedy',2010,7.8),
('Monsters vs. Aliens','comedy',2009,6.6),
('Happy Feet','comedy',2006,6.5),
('Ice Age: The Meltdown','comedy',2009,7.0),
('Ice Age: The Meltdown','comdey',2006,6.9),
('World War Z','horror',2013,7.0),
('What Lies Beneath','horror',2000,6.6),
('Gremlins','horror',1984,7.2),
('The Blair Witch Project','horror',1999,6.4),
('The Conjuring','horror',2013,7.5),
('The Ring','horror',2002,7.1),
('The Grudge','horror',2004,5.9),
('Paranormal Activity','horror',2007,6.3),
('Interview with the Vampire: The Vampire Chronicles','horror',1994,7.6),
('Paranormal Activity 3','horror',2011,5.9),
('Scream','horror',1996,7.2),
('Jaws 2','horror',1978,5.7),
('Scream 2','horror',1997,6.1),
('Sleepy Hollow','horror',1999,7.4),
('The Others','horror',2001,7.6),
('The Haunting','horror',1999,4.9),
('Scream 3','horror',2000,5.5),
('Saw II','horror',2005,6.6),
('The Amityville Horror','horror',1979,6.2),
('Aliens','horror',1986,8.4),
('Paranormal Activity 2','horror',2010,5.7),
('Annabelle','horror',2014,5.4),
('Scooby-Doo 2: Monsters Unleashed','horror',2004,4.9),
('Insidious: Chapter 2','horror',2013,6.6),
('Dracula','horror',1992,7.5),
('Freddy vs. Jason','horror',2003,5.8),
('Blade II','horror',2002,6.7),
('Saw III','horror',2006,6.2),
('The Texas Chainsaw Massacre','horror',2003,6.2),
('Cloverfield','horror',2008,7.1),
('Dark Shadows','horror',2012,6.2),
('The Ring Two','horror',2005,5.4),
('Zombieland','horror',2009,7.7),
('Constantine','horror',2005,6.9),
('The Exorcism of Emily Rose','horror',2005,6.7),
('I Know What You Did Last Summer','horror',1997,5.6),
('1408','horror',2007,6.8),
('Mama','horror',2013,6.2),
('The Purge: Anarchy','horror',2014,6.5),
('Scary Movie 2','horror',2001,5.2),
('Blade','horror',1998,7.1),
('End of Days','horror',1999,5.7),
('The Forgotten','horror',2004,5.8),
('The Final Destination','horror',2009,5.2),
('Warm Bodies','horror',2013,6.9),
('Anaconda','horror',1997,4.6),
('Wolf','horror',1994,6.2),
('Friday the 13th','horror',2009,5.6),
('The Purge','horror',2013,5.6),
('Titanic','romance',1997,7.7),
('Forrest Gump','romance',1994,8.8),
('The Twilight Saga: Eclipse','romance',2010,4.9),
('The Twilight Saga: New Moon','romance',2009,4.6),
('The Twilight Saga: Breaking Dawn - Part 2','romance',2012,5.6),
('The Twilight Saga: Breaking Dawn - Part 1','romance',2011,4.9),
('Beauty and the Beast','romance',1991,8.0),
('King Kong','romance',2005,7.3),
('Ghost','romance',1990,7.0),
('Cinderella','romance',2015,7.1),
('Gone with the Wind','romance',1939,8.2),
('Pearl Harbor','romance',2001,6.0),
('Twilight','romance',2008,5.2),
('Mr. & Mrs. Smith','romance',2005,6.5),
('Snow White and the Seven Dwarfs','romance',1937,7.7),
('What Women Want','romance',2000,6.4),
('Top Gun','romance',1986,6.8),
('Pretty Woman','romance',1990,6.9),
('Hitch','romance',2005,6.7),
('Tootsie','romance',1982,7.4),
('Theres Something About Mary','romance',1998,7.1),
('Elf','romance',2003,6.9),
('Tarzan','romance',1999,7.2),
('Bridesmaids','romance',2011,6.8),
('Fifty Shades of Grey','romance',2015,4.2),
('Robin Hood: Prince of Thieves','romance',1991,6.9),
('The Proposal','romance',2009,6.7),
('The Sound of Music','romance',1965,8.0),
('Jerry Maguire','romance',1996,7.3),
('Sex and the City','romance',2008,5.5),
('Runaway Bride','romance',1999,5.4),
('Les Misérables','romance',2012,7.6),
('Knocked Up','romance',2007,7.1),
('Little Fockers','romance',2010,5.5),
('As Good as It Gets','romance',1997,7.8),
('American Pie 2','romance',2001,6.4),
('The Great Gatsby','romance',2013,7.3),
('Mamma Mia!','romance',2008,6.4),
('Juno','romance',2007,7.5),
('Marley & Me','romance',2008,7.1),
('Pocahontas','romance',1995,6.6),
('Slumdog Millionaire','romance',2008,8.0),
('Look Whos Talking','romance',1989,5.8),
('Click','romance',2006,6.4),
('The Lion King','drama',1994,8.5),
('Harry Potter and the Deathly Hallows: Part 2','drama',2011,8.1),
('The Sixth Sense','drama',1999,8.2),
('Jaws','drama',1975,8.1),
('I Am Legend','drama',2007,7.2),
('The Blind Side','drama',2009,7.7),
('Cast Away','drama',2000,7.7),
('Signs','drama',2002,6.7),
('Saving Private Ryan','drama',1998,8.6),
('Dawn of the Planet of the Apes','drama',2014,7.1),
('Interstellar','drama',2014,8.7),
('Gladiator','drama',2000,8.5),
('Dances with Wolves','drama',1990,8.0),
('The Perfect Storm','drama',2000,6.4),
('Lincoln','drama',2012,7.4),
('Rise of the Planet of the Apes','drama',2011,7.6),
('The Karate Kid','drama',2010,6.2),
('Rain Man','drama',1988,8.0),
('Air Force One','drama',1997,6.4),
('True Grit','drama',2010,7.7),
('A Beautiful Mind','drama',2001,8.2),
('The Help','drama',2011,8.1),
('3 Men and a Baby','drama',1987,5.9),
('Gone Girl','drama',2014,8.2),
('Kung Fu Panda 2','drama',2011,7.3),
('Hannibal','drama',2001,6.7),
('Catch Me If You Can','drama',2002,8.0),
('Big Daddy','drama',1999,6.4),
('Se7en','drama',1995,8.6),
('Seven','drama',1979,6.1),
('The Good, the Bad and the Ugly',NULL,NULL,NULL),
('Dawn of the Dead','horror',1978,NULL),
('Shawn of the Dead','comedy',2004,NULL),
('Star Wars: The Force Awakens','action',2015,8.1),
('Star Wars: The Last Jedi','action',2017,NULL),
('The Shining','horror',1985,8.4),
('The Devil and Daniel Johnston',NULL,2005,8.0),
('Ali Wong: Baby Cobra',NULL,2016,NULL),
('The Big Sick','romance',2017,NULL),
('Deadpool','action',2016,NULL)
;
      
SELECT * FROM movies;
```

---

![image](https://user-images.githubusercontent.com/107522496/208564889-c034f51d-e49a-403c-a828-9a421d32c150.png)

![image](https://user-images.githubusercontent.com/107522496/208564910-de619849-231f-43aa-a514-8bf87fced7ec.png)


---

# `SELECT`

Previously, we learned that `SELECT` is used every time you want to query data from a database and `*` means all columns.

What if we are only intrested in two columns. We can select individual columns by their names (separated by a comma):

```sql
SELECT column1, column2 
FROM table_name;
```

To make it easier to read, we moved FROM to another line.

Line breaks don’t mean anything specific in SQL. We could write this entire query in one line, and it would run just fine. 

# Practise 

1. Let’s only select the name and genre columns of the table. In the code editor, type the following:

```sql
SELECT name, genre 
FROM movies;
```

> SELECT and FROM are clauses. Clauses perform specific tasks in SQL. By convention, clauses are written in capital letters.

![image](https://user-images.githubusercontent.com/107522496/208632033-00c32db6-6733-4748-a9b5-35a835a7fdbd.png)

---

-- Step 2: Now we want to include a third column. Edit your query so that it returns the name, genre, and year columns of the table. 

```sql
SELECT name, genre, year FROM movies;
```

![image](https://user-images.githubusercontent.com/107522496/208632157-dc3e83f0-d4d9-44ab-b276-7425899088ab.png)

---

Tip: The syntax for selecting three individual columns:

```sql
SELECT column1, column2, column3
FROM table_name;
```

* We have to separate the column names with a comma.
* SQL commands end with a `;`.

---

# `AS`

The code below:

```sql
SELECT name AS 'Titles'
FROM movies;
```

`AS` is a keyword in SQL that allows you to **rename** a column or table using an alias. The new name can be anything you want as long as you put it **inside of single quotes**. Here we renamed the name column as Titles.

Some important things to note:

* Although it’s not always necessary, it’s best practice to surround your aliases with single quotes.
* When using `AS`, the columns are not being renamed in the table. The aliases only appear in the result.

---

# Practise 

Step 1: To showcase what the AS keyword does, select the name column and rename it with an alias of your choosing. Place the alias inside single quotes, like so:

```sql
SELECT name AS '______'
FROM movies;
```

![image](https://user-images.githubusercontent.com/107522496/208634565-9582d47b-a592-4192-828c-25c01063ec56.png)

---

Step 2: Edit the query so that instead of selecting and renaming the name column, select the imdb_rating column and rename it as IMDb.

```sql
SELECT imdb_rating AS 'IMDb' FROM movies;
```

![image](https://user-images.githubusercontent.com/107522496/208634869-e2c4fd7c-77ca-4eff-b30f-40bdb827422c.png)

---

Tip: The `AS` syntax is as follows:

```sql
SELECT column AS 'Nickname' 
FROM table_name;
```

Put single quotes around the alias.

Suppose you want to rename the name column as Binge, then the query would look like:

```sql
SELECT name AS 'Binge' 
FROM movies;
```

---

# `DISTINCT`

When we are examining data in a table, it can be helpful to know what distinct values exist in a particular column. DISTINCT is used to return unique values in the output. It filters out all duplicate values in the specified column(s). For instance,

```sql
SELECT tools 
FROM inventory;
```

might produce:

```yaml
tools
Hammer
Nails
Nails
Nails
```

By adding `DISTINCT` before the column name,

```sql
SELECT DISTINCT tools 
FROM inventory;
```

Filtering the results of a query is an important skill in SQL. It is easier to see the different possible genres in the movie table after the data has been filtered than to scan every row in the table.

---

# Practise 


Step 1: output all **unique** genres in the `movies` table:

```sql
SELECT DISTINCT genre FROM movies;
```

![image](https://user-images.githubusercontent.com/107522496/208636390-755440ee-f8e7-4295-8ce7-4f46b209f54a.png)

The different genres are:

* action
* comedy
* horror
* romance
* drama
* ∅

The empty set symbol ∅ is just an empty value. DISTINCT recognize empty values, too.

---

Step 2: Now, change the code so we return the unique values of the year column instead.

```sql
SELECT DISTINCT year FROM movies;
```

![image](https://user-images.githubusercontent.com/107522496/208636636-ab8fb17c-c01a-4bc1-a615-2dd0f8726a2d.png)

Tip: Suppose we only want to query the distinct results from a column. We will use the syntax:

```sql
SELECT DISTINCT column
FROM table_name;
```
Note: You might’ve noticed how there appears to be an empty set symbol ∅ near the bottom of the results (right below 1987 and above 2017). It is not a bug! `DISTINCT` recognize empty values, too.

---

# `WHERE`

We can **restrict our query** results using the WHERE clause in order to obtain only the information we want. Following this format, the statement below filters the result set to only include top rated movies (IMDb ratings greater than 8):

```sql
SELECT *
FROM movies
WHERE imdb_rating > 8;
```

1. The `WHERE` clause filters the result set to only include rows where the following condition is true.

2. imdb_rating > 8 is the condition. Here, only rows with a value greater than 8 in the imdb_rating column will be returned.

The `>` is an operator. Operators create a condition that can be evaluated as either _true_ or _false_.

Comparison operators used with the WHERE clause are:

* `=` equal to
* `!=` not equal to
* `>` greater than
* `<` less than
* `>=` greater than or equal to
* `<=` less than or equal to

---

# Practise 

1. Output all movies with a IMDb rating of less than 5

```sql
SELECT * FROM movies
WHERE imdb_rating < 5; 
```

![image](https://user-images.githubusercontent.com/107522496/208638309-e329e2c7-597d-43d5-a383-7849047101f3.png)

Tip: We are trying to retrieve all the movies with ratings lower than 5.

Common errors:

* Missing underscore in the imdb_rating column name. 
* Missing `;` at the end.

---

Step 2: Edit the query so that it will now retrieve all the recent movies, specifically those that were released after 2014.

```sql
SELECT * FROM movies
WHERE year > 2014;
```
Tip: The condition here would be `year > 2014`.

![image](https://user-images.githubusercontent.com/107522496/208639122-8d257063-a731-44ae-b091-9c372879d5f0.png)

---

# `LIKE` Part 1
















